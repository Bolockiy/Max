Задание 2

2.1 
CREATE TABLE courses(student varchar(10), class varchar(25));

INSERT INTO courses VALUES('A', 'Math');
INSERT INTO courses VALUES('B', 'English');
INSERT INTO courses VALUES('C', 'Math');
INSERT INTO courses VALUES('D', 'Biology');
INSERT INTO courses VALUES('E', 'Math');
INSERT INTO courses VALUES('F', 'Computer');
INSERT INTO courses VALUES('G', 'Math');
INSERT INTO courses VALUES('H', 'Math');
INSERT INTO courses VALUES('I', 'Math');
INSERT INTO courses VALUES('A', 'Math');

SELECT class FROM courses
GROUP BY class 
HAVING COUNT(DISTINCT student) > 5

2.2 
CREATE TABLE salary (
    id INT PRIMARY KEY,
    name VARCHAR(50),
    sex CHAR(1),
    salary INT
);
INSERT INTO salary (id, name, sex, salary) VALUES
(1, 'A', 'm', 2500),
(2, 'B', 'f', 1500),
(3, 'C', 'm', 5500),
(4, 'D', 'f', 500);

UPDATE salary 
SET sex = CASE 
    WHEN sex = 'm' THEN 'f' 
    WHEN sex = 'f' THEN 'm' 
END;
SELECT * FROM salary;

2.3 
CREATE TABLE Person(PersonId int PRIMARY KEY, FirstName varchar(25), LastName varchar(25));
CREATE TABLE Adress(AdressId int PRIMARY KEY, PersonId int, city varchar(25), State varchar(25));

INSERT INTO Person VALUES(1,'Вася', 'Пупкин');
INSERT INTO Person VALUES(2,'Олег', 'Попкорнов');
INSERT INTO Person VALUES(3,'Владимир', 'Васин');
INSERT INTO Adress VALUES(1,1,'Москва', 'Россия');
INSERT INTO Adress VALUES(2,2,'Санкт-Петербург', 'Патриотов');
INSERT INTO Adress VALUES(3,3,'', '');

SELECT FirstName, LastName, City, State FROM Person
JOIN Adress ON Person.PersonId = Adress.PersonId

2.4 
CREATE TABLE email (
    Id INT PRIMARY KEY,
    Email VARCHAR(255)
);
INSERT INTO email (Id, Email) VALUES
(1, 'a@b.com'),
(2, 'c@d.com'),
(3, 'a@b.com');
DELETE FROM email
WHERE Id NOT IN (
    SELECT MIN(Id)
    FROM email
    GROUP BY Email
);
SELECT * FROM email;

